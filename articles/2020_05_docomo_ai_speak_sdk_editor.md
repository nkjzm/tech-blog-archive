---
title: "ã€Unityã€‘ãƒ‰ã‚³ãƒ¢AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆAPI SpeakSDKã®ã‚µãƒ³ãƒ—ãƒ«ã‚’Editorä¸Šã§å®Ÿè¡Œã™ã‚‹"
emoji: "ğŸ®"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Unity"]
published: true
---

# åˆã‚ã«

ã€ŒSpeakSDK for Unity ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã®å®Ÿè¡Œæ‰‹é †ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚ãƒˆãƒ©ã‚¤ã‚¢ãƒ«ã‚µãƒ¼ãƒå‘ã‘ã®æ‰‹é †ã§ã™ã€‚
[docomoDeveloperSupport/speak-unity-sample](https://github.com/docomoDeveloperSupport/speak-unity-sample)

æ¦‚ã­ä»¥ä¸‹ã®è¨˜äº‹ã®é€šã‚Šã§ã™ãŒã€å°‘ã—ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰ã‚ã£ã¦ã„ãŸã®ã§è£œè¶³ã—ã¦ã„ãã¾ã™ã€‚
[ãƒ‰ã‚³ãƒ¢AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆAPIã‚’ä½¿ã£ã¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¨ä¼šè©±ã™ã‚‹ - Qiita](https://qiita.com/broken55/items/5cdda8366aa2b6fa6fc0)

# ç’°å¢ƒ

- Windows 10 Home
- Untiy 2019.3.13f1ï¼ˆæ¨å¥¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯2019.3.2f1ï¼‰
- speak-unity-sdk v1.14.4

# æµã‚Œ

1. ã‚µãƒ³ãƒ—ãƒ«ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
2. SDKã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
3. ãƒ‡ãƒã‚¤ã‚¹IDã®å–å¾—
4. ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—
5. Unityä¸Šã§ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™»éŒ²
6. å®Ÿè¡Œ

# æ‰‹é †

ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰æ¯cloneã€ã‚‚ã—ãã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚
https://github.com/docomoDeveloperSupport/speak-unity-sample

speak-unity-sdkã®æœ€æ–°ç‰ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚
https://github.com/docomoDeveloperSupport/speak-unity-sdk/releases/latest

Uniyã§speak-unity-sampleã‚’é–‹ãã€å…ˆã»ã©ã®SDKã‚’Unityãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸Šã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚

æ¬¡ã«ãƒ‡ãƒã‚¤ã‚¹IDã‚’å–å¾—ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã«ãƒ­ã‚°ã‚¤ãƒ³ã‚’ã—ã€è¨­å®šã‹ã‚‰ã€Œãƒ‡ãƒã‚¤ã‚¹IDã®è¿½åŠ ã€ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚ãƒ‡ãƒã‚¤ã‚¹IDãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€ãƒ¡ãƒ¢ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚
https://agentcraft.sebastien.ai/

ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã«ãƒ­ã‚°ã‚¤ãƒ³ã‚’ã—ã€å·¦ä¸Šã®ã€Œï¼‹ã€ã‚¢ã‚¤ã‚³ãƒ³ã‹ã‚‰æ–°è¦ãƒ‡ãƒã‚¤ã‚¹ç™»éŒ²ç”»é¢ã‚’é–‹ã„ã¦ãã ã•ã„ã€‚å…ˆã»ã©ã®ãƒ‡ãƒã‚¤ã‚¹IDã‚’å…¥åŠ›ã—ã€ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚
https://users-v2.sebastien.ai/

ã‚µãƒ³ãƒ—ãƒ«ã®ç›´ä¸‹ã«å…¥ã£ã¦ã„ã‚‹`GetTrialDeviceToken.py`ã‚’å®Ÿè¡Œã™ã‚‹æº–å‚™ã‚’ã—ã¾ã™ã€‚

ã¾ãšã¯`GetTrialDeviceToken.py`ã‚’é©å½“ãªã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆãƒ¡ãƒ¢å¸³ã§ã‚‚OKï¼‰ã§é–‹ãã€42è¡Œç›®ã®`XXXXXXXXXXXXXXXXXXXX`éƒ¨åˆ†ã‚’å…ˆã»ã©å–å¾—ã—ãŸãƒ‡ãƒã‚¤ã‚¹IDã«æ›¸ãæ›ãˆã¦ä¿å­˜ã—ã¾ã™ã€‚

```ï¼ˆæŠœç²‹ï¼‰GetTrialDeviceToken.py
CONFIG = {
    "trial":{
        "device_id":"XXXXXXXXXXXXXXXXXXXX",
        "uds":"https://users-v2.sebastien.ai"
    }
}
```
å¼•ç”¨å…ƒï¼šhttps://github.com/docomoDeveloperSupport/speak-unity-sample/blob/master/GetTrialDeviceToken.py#L40-L45

æ¬¡ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
Windowsã®å ´åˆã¯python3ã®å®Ÿè¡Œç’°å¢ƒãŒå¿…è¦ãªã®ã§ã€ã“ã¡ã‚‰ã‚’å‚è€ƒã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚ãƒ‘ã‚¹ã‚’é€šã™ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãŠã‘ã°ã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ãŒæ‰“ã¦ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
https://www.python.jp/install/windows/install_py3.html

python3ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸Šã§ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

```bash
# ã‚µãƒ³ãƒ—ãƒ«ã®ã‚³ãƒ¼ãƒ‰ã«ç§»å‹•
$ cd move/your/directory
# ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®ç™ºè¡Œ
$ python GetTrialDeviceToken.py
```

ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’æŠ¼ã—ã¾ã™ã€‚ä»Šã¾ã§ã®æ‰‹é †ãŒæˆåŠŸã—ã¦ã„ã‚Œã°æ¬¡ã®ã‚ˆã†ãªå‡ºåŠ›ãŒã•ã‚Œã¾ã™ã€‚

```bash
{
    "device_token": "yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy", 
    "refresh_token": "oooooooo-oooo-oooo-oooo-oooooooooooo", 
    "status": "valid"
}
SAVE ./.trial_device_token : yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy
SAVE ./.trial_refresh_token : oooooooo-oooo-oooo-oooo-oooooooooooo
```

`device_token`ã®å³å´ã«ã‚ã‚‹`yyyyyyyy-yyyy-yyyy-yyyy-yyyyyyyyyyyy`ã®éƒ¨åˆ†ãŒãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãªã®ã§ã€ãƒ¡ãƒ¢ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚

æ¬¡ã«ã€Unityä¸Šã§ãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™»éŒ²ã—ã¾ã™ã€‚`Assets/Scripts/SpeakSDKManager.cs`ã®139, 140è¡Œç›®ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¦ãã ã•ã„ã€‚

- `wss://hostname.domain:443/path` -> `wss://spf-v2.sebastien.ai/talk`
- `PUT_YOUR_DEVICE_TOKEN` -> å…ˆã»ã©ç™ºè¡Œã—ãŸãƒ‡ãƒã‚¤ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆãƒ‡ãƒã‚¤ã‚¹IDã§ã¯ãªã„ï¼‰

```ï¼ˆæŠœç²‹ï¼‰SpeakSDKManager.cs
    // ---------------------------------------------------------------------------- //
    //  SDKåˆæœŸåŒ–å‡¦ç†
    // ---------------------------------------------------------------------------- //
    private void InitializeSpeakSDK()
    {
        Speak.Instance().SetURL("wss://hostname.domain:443/path");
        Speak.Instance().SetDeviceToken("PUT_YOUR_DEVICE_TOKEN");

        // Callback.
        Speak.Instance().SetOnTextOut(OnTextOut);
        Speak.Instance().SetOnMetaOut(OnMetaOut);
    }
```
å¼•ç”¨å…ƒï¼šhttps://github.com/docomoDeveloperSupport/speak-unity-sample/blob/master/sample_app/SpeakSampleApp/Assets/Scripts/SpeakSDKManager.cs#L134-L145

Editorä¸Šã§SDKã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯DLLã®è¨­å®šã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆ64bitç’°å¢ƒã®å ´åˆï¼‰`Assets/Plugins/Windows/x86_64/flow.dll`ã®include platformã§`Editor`ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã€Applyãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚

![sdfasdfas.PNG](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/55365/ab8b6d58-0d67-b9c2-7d48-a5905c089862.png)

æº–å‚™ã¯ä»¥ä¸Šã§ã™ã€‚Unityã®`Assets/Scenes/main.unity`ã‚’é–‹ãã€ã‚·ãƒ¼ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

`SDKstart`ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨å°‘ã—å¾…ã£ã¦ç·‘è‰²ã«å¤‰åŒ–ã—ã¾ã™ã€‚ãã®çŠ¶æ…‹ã§ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã€Œã“ã‚“ã«ã¡ã¯ã€ãªã©ã¨æ‰“ã£ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆã¨éŸ³å£°ãŒå†ç”Ÿã•ã‚Œã‚Œã°æˆåŠŸã§ã™ã€‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€‚

![fasdfasdfas.PNG](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/55365/625fe301-054e-eccd-8363-3bfb7def2d10.png)

# æœ€å¾Œã«

å®£ä¼ã§ã™ãŒã€ æœˆé¡åˆ¶ã®ãƒ¡ãƒ³ã‚¿ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã§åˆå¿ƒè€…å‘ã‘ã®é–‹ç™ºã‚µãƒãƒ¼ãƒˆã‚’ã—ã¦ã„ã‚‹ã®ã§ã€åˆ†ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚Œã°æ˜¯éã“ã¡ã‚‰ã§è³ªå•ã—ã¦ãã ã•ã„ï¼ã€€
https://menta.work/plan/1115
