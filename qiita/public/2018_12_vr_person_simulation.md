---
title: 【VR学まとめ】4.3.4 人物のシミュレーション
published_at: '2018-12-24 01:57'
private: false
tags:
  - VR
updated_at: '2018-12-24T01:57:12+09:00'
id: 01c1f2962b3ec7a704b3
organization_url_name: null
slide: false
---
# はじめに

この記事は[一人VR技術者認定試験 Advent Calendar 2018](https://qiita.com/advent-calendar/2018/vr-engineer)の22日目の記事です。

[バーチャルリアリティ学](https://www.amazon.co.jp/バーチャルリアリティ学-舘-暲/dp/4904490053)の4章「バーチャル世界の構成手法」の内容をまとめていきます。
書籍の方も是非ご購入いただいた上でご利用ください。

# 4 バーチャル世界の構成手法

## 4.3 シミュレーション

### 4.3.4 人物のシミュレーション

#### (1) 人体物理モデル

- 剛体リンク系
    - 現実的な計算時間でシミュレートするために使う
    - 球面関節
        - 3自由度回転
    - 回転関節
        - 1自由度
    - 実際は回転中心が移動したりする

![JPEG image-E230E8ACB49C-1.jpeg](https://qiita-image-store.s3.amazonaws.com/0/55365/9653cdce-d3c0-49f4-7928-6a8bac129b9b.jpeg)
引用元: [バーチャルリアリティ学](https://www.amazon.co.jp/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%AB%E3%83%AA%E3%82%A2%E3%83%AA%E3%83%86%E3%82%A3%E5%AD%A6-%E8%88%98-%E6%9A%B2/dp/4904490053)

#### (2) 計算アルゴリズム

- 力学シミュレーション(4.3.3参照)
- 逆運動学
    - リンクの位置と姿勢に対応する関節角を計算する
    - 解析的手法
        - 逆関数を求める
    - 数値的手法
        - ヤコビ行列と位置誤差の2上を評価関数とした最適化問題を解く方法
        - ニュートン法を用いて方程式の解を求める方法
        - 汎用性が高く応用も聴く
    - 解が無限に存在する
        - 手の位置・姿勢を変えずに肘の位置を変えられるなど


![JPEG image-ADFEE35BDD67-1.jpeg](https://qiita-image-store.s3.amazonaws.com/0/55365/92aebc8f-1cbd-3606-0759-a1a22d006d54.jpeg)
引用元: [バーチャルリアリティ学](https://www.amazon.co.jp/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%AB%E3%83%AA%E3%82%A2%E3%83%AA%E3%83%86%E3%82%A3%E5%AD%A6-%E8%88%98-%E6%9A%B2/dp/4904490053)

#### (3) 運動生成

- 映画などではアニメーターがキーフレームを補間して制作する方法が主流
- リアルタイム生成する必要がある

- 力学シミュレーション
    - 人間らしい運動をするための関節トルクを計算する制御系が必要
        - 転倒しないための制御
    - 関節制御
        - 各関節は与えられた目標値に追従する
        - 全体のバランスは考慮されていない
    - バランス制御
        - 重心位置を目標位置に戻すための仮想的な力を計算し、各関節のトルクに変換する
        - 外力に対する反応の運動を生成できる
        - バランス制御は保証されていない
    - 有限状態機械
        - 各状態の制御系は事前に用意しておく

![JPEG image-ADFEE35BDD67-2.jpeg](https://qiita-image-store.s3.amazonaws.com/0/55365/7402a0ee-b3af-466e-c0a0-3bb5c1102631.jpeg)
引用元: [バーチャルリアリティ学](https://www.amazon.co.jp/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%AB%E3%83%AA%E3%82%A2%E3%83%AA%E3%83%86%E3%82%A3%E5%AD%A6-%E8%88%98-%E6%9A%B2/dp/4904490053)

- モーションキャプチャを利用する方法
    - 計測したデータを加工するので基本的に転倒などがない
    - モーショングラフ
        - クリップを複数用意して状況に応じた順序で再生する方法
        - 似た姿勢で遷移すれば滑らかになる

![JPEG image-ADFEE35BDD67-3.jpeg](https://qiita-image-store.s3.amazonaws.com/0/55365/31ee65f6-0481-62c1-d9ac-711766046a68.jpeg)
引用元: [バーチャルリアリティ学](https://www.amazon.co.jp/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%AB%E3%83%AA%E3%82%A2%E3%83%AA%E3%83%86%E3%82%A3%E5%AD%A6-%E8%88%98-%E6%9A%B2/dp/4904490053)

# まとめ

バランス制御は難しいですね。

[一人VR技術者認定試験 Advent Calendar 2018](https://qiita.com/advent-calendar/2018/vr-engineer)の23日目は[第15回VR技術者認定試験（セオリーコース） 模範解答の予想](https://qiita.com/nkjzm/items/d4fd092623fbf09cd104)です
